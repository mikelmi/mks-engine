!function(){"use strict";angular.module("ui.tree",[]).constant("treeConfig",{treeClass:"angular-ui-tree",emptyTreeClass:"angular-ui-tree-empty",hiddenClass:"angular-ui-tree-hidden",nodesClass:"angular-ui-tree-nodes",nodeClass:"angular-ui-tree-node",handleClass:"angular-ui-tree-handle",placeholderClass:"angular-ui-tree-placeholder",dragClass:"angular-ui-tree-drag",dragThreshold:3,levelThreshold:30,defaultCollapsed:!1})}(),function(){"use strict";angular.module("ui.tree").controller("TreeHandleController",["$scope","$element",function(e,n){this.scope=e,e.$element=n,e.$nodeScope=null,e.$type="uiTreeHandle"}])}(),function(){"use strict";angular.module("ui.tree").controller("TreeNodeController",["$scope","$element",function(e,n){function t(e){var n,o,r,l=0,a=e.childNodes();if(!a||0===a.length)return 0;for(r=a.length-1;r>=0;r--)n=a[r],o=1+t(n),l=Math.max(l,o);return l}this.scope=e,e.$element=n,e.$modelValue=null,e.$parentNodeScope=null,e.$childNodesScope=null,e.$parentNodesScope=null,e.$treeScope=null,e.$handleScope=null,e.$type="uiTreeNode",e.$$allowNodeDrop=!1,e.collapsed=!1,e.expandOnHover=!1,e.init=function(t){var o=t[0];e.$treeScope=t[1]?t[1].scope:null,e.$parentNodeScope=o.scope.$nodeScope,e.$modelValue=o.scope.$modelValue[e.$index],e.$parentNodesScope=o.scope,o.scope.initSubNode(e),n.on("$destroy",function(){o.scope.destroySubNode(e)})},e.index=function(){return e.$parentNodesScope.$modelValue.indexOf(e.$modelValue)},e.dragEnabled=function(){return!(e.$treeScope&&!e.$treeScope.dragEnabled)},e.isSibling=function(n){return e.$parentNodesScope==n.$parentNodesScope},e.isChild=function(n){var t=e.childNodes();return t&&t.indexOf(n)>-1},e.prev=function(){var n=e.index();return n>0?e.siblings()[n-1]:null},e.siblings=function(){return e.$parentNodesScope.childNodes()},e.childNodesCount=function(){return e.childNodes()?e.childNodes().length:0},e.hasChild=function(){return e.childNodesCount()>0},e.childNodes=function(){return e.$childNodesScope&&e.$childNodesScope.$modelValue?e.$childNodesScope.childNodes():null},e.accept=function(n,t){return e.$childNodesScope&&e.$childNodesScope.$modelValue&&e.$childNodesScope.accept(n,t)},e.remove=function(){return e.$parentNodesScope.removeNode(e)},e.toggle=function(){e.collapsed=!e.collapsed,e.$treeScope.$callbacks.toggle(e.collapsed,e)},e.collapse=function(){e.collapsed=!0},e.expand=function(){e.collapsed=!1},e.depth=function(){var n=e.$parentNodeScope;return n?n.depth()+1:1},e.maxSubDepth=function(){return e.$childNodesScope?t(e.$childNodesScope):0}}])}(),function(){"use strict";angular.module("ui.tree").controller("TreeNodesController",["$scope","$element",function(e,n){this.scope=e,e.$element=n,e.$modelValue=null,e.$nodeScope=null,e.$treeScope=null,e.$type="uiTreeNodes",e.$nodesMap={},e.nodropEnabled=!1,e.maxDepth=0,e.cloneEnabled=!1,e.initSubNode=function(n){return n.$modelValue?void(e.$nodesMap[n.$modelValue.$$hashKey]=n):null},e.destroySubNode=function(n){return n.$modelValue?void(e.$nodesMap[n.$modelValue.$$hashKey]=null):null},e.accept=function(n,t){return e.$treeScope.$callbacks.accept(n,e,t)},e.beforeDrag=function(n){return e.$treeScope.$callbacks.beforeDrag(n)},e.isParent=function(n){return n.$parentNodesScope==e},e.hasChild=function(){return e.$modelValue.length>0},e.safeApply=function(e){var n=this.$root.$$phase;"$apply"==n||"$digest"==n?e&&"function"==typeof e&&e():this.$apply(e)},e.removeNode=function(n){var t=e.$modelValue.indexOf(n.$modelValue);return t>-1?(e.safeApply(function(){e.$modelValue.splice(t,1)[0]}),e.$treeScope.$callbacks.removed(n)):null},e.insertNode=function(n,t){e.safeApply(function(){e.$modelValue.splice(n,0,t)})},e.childNodes=function(){var n,t=[];if(e.$modelValue)for(n=0;n<e.$modelValue.length;n++)t.push(e.$nodesMap[e.$modelValue[n].$$hashKey]);return t},e.depth=function(){return e.$nodeScope?e.$nodeScope.depth():0},e.outOfDepth=function(n){var t=e.maxDepth||e.$treeScope.maxDepth;return t>0&&e.depth()+n.maxSubDepth()+1>t}}])}(),function(){"use strict";angular.module("ui.tree").controller("TreeController",["$scope","$element",function(e,n){this.scope=e,e.$element=n,e.$nodesScope=null,e.$type="uiTree",e.$emptyElm=null,e.$callbacks=null,e.dragEnabled=!0,e.emptyPlaceholderEnabled=!0,e.maxDepth=0,e.dragDelay=0,e.cloneEnabled=!1,e.nodropEnabled=!1,e.isEmpty=function(){return e.$nodesScope&&e.$nodesScope.$modelValue&&0===e.$nodesScope.$modelValue.length},e.place=function(n){e.$nodesScope.$element.append(n),e.$emptyElm.remove()},this.resetEmptyElement=function(){e.$nodesScope.$modelValue&&0!==e.$nodesScope.$modelValue.length||!e.emptyPlaceholderEnabled?e.$emptyElm.remove():n.append(e.$emptyElm)},e.resetEmptyElement=this.resetEmptyElement}])}(),function(){"use strict";angular.module("ui.tree").directive("uiTree",["treeConfig","$window",function(e,n){return{restrict:"A",scope:!0,controller:"TreeController",link:function(t,o,r,l){var a,i,d,u={accept:null,beforeDrag:null},c={};angular.extend(c,e),c.treeClass&&o.addClass(c.treeClass),"table"===o.prop("tagName").toLowerCase()?(t.$emptyElm=angular.element(n.document.createElement("tr")),i=o.find("tr"),d=i.length>0?angular.element(i).children().length:1e6,a=angular.element(n.document.createElement("td")).attr("colspan",d),t.$emptyElm.append(a)):t.$emptyElm=angular.element(n.document.createElement("div")),c.emptyTreeClass&&t.$emptyElm.addClass(c.emptyTreeClass),t.$watch("$nodesScope.$modelValue.length",function(e){angular.isNumber(e)&&l.resetEmptyElement()},!0),t.$watch(r.dragEnabled,function(e){"boolean"==typeof e&&(t.dragEnabled=e)}),t.$watch(r.emptyPlaceholderEnabled,function(e){"boolean"==typeof e&&(t.emptyPlaceholderEnabled=e,l.resetEmptyElement())}),t.$watch(r.nodropEnabled,function(e){"boolean"==typeof e&&(t.nodropEnabled=e)}),t.$watch(r.cloneEnabled,function(e){"boolean"==typeof e&&(t.cloneEnabled=e)}),t.$watch(r.maxDepth,function(e){"number"==typeof e&&(t.maxDepth=e)}),t.$watch(r.dragDelay,function(e){"number"==typeof e&&(t.dragDelay=e)}),u.accept=function(e,n,t){return!(n.nodropEnabled||n.$treeScope.nodropEnabled||n.outOfDepth(e))},u.beforeDrag=function(e){return!0},u.expandTimeoutStart=function(){},u.expandTimeoutCancel=function(){},u.expandTimeoutEnd=function(){},u.removed=function(e){},u.dropped=function(e){},u.dragStart=function(e){},u.dragMove=function(e){},u.dragStop=function(e){},u.beforeDrop=function(e){},u.toggle=function(e,n){},t.$watch(r.uiTree,function(e,n){angular.forEach(e,function(e,n){u[n]&&"function"==typeof e&&(u[n]=e)}),t.$callbacks=u},!0)}}}])}(),function(){"use strict";angular.module("ui.tree").directive("uiTreeHandle",["treeConfig",function(e){return{require:"^uiTreeNode",restrict:"A",scope:!0,controller:"TreeHandleController",link:function(n,t,o,r){var l={};angular.extend(l,e),l.handleClass&&t.addClass(l.handleClass),n!=r.scope&&(n.$nodeScope=r.scope,r.scope.$handleScope=n)}}}])}(),function(){"use strict";angular.module("ui.tree").directive("uiTreeNode",["treeConfig","UiTreeHelper","$window","$document","$timeout","$q",function(e,n,t,o,r,l){return{require:["^uiTreeNodes","^uiTree"],restrict:"A",controller:"TreeNodeController",link:function(a,i,d,u){var c,s,p,m,f,h,g,$,v,b,y,S,x,N,E,T,C,w,O,D,M,A,H,k,X={},Y="ontouchstart"in window,V=null,I=document.body,_=document.documentElement;angular.extend(X,e),X.nodeClass&&i.addClass(X.nodeClass),a.init(u),a.collapsed=!!n.getNodeAttribute(a,"collapsed")||e.defaultCollapsed,a.expandOnHover=!!n.getNodeAttribute(a,"expandOnHover"),a.sourceOnly=a.nodropEnabled||a.$treeScope.nodropEnabled,a.$watch(d.collapsed,function(e){"boolean"==typeof e&&(a.collapsed=e)}),a.$watch("collapsed",function(e){n.setNodeAttribute(a,"collapsed",e),d.$set("collapsed",e)}),a.$watch(d.expandOnHover,function(e){"boolean"!=typeof e&&"number"!=typeof e||(a.expandOnHover=e)}),a.$watch("expandOnHover",function(e){n.setNodeAttribute(a,"expandOnHover",e),d.$set("expandOnHover",e)}),a.$on("angular-ui-tree:collapse-all",function(){a.collapsed=!0}),a.$on("angular-ui-tree:expand-all",function(){a.collapsed=!1}),b=function(e){if((Y||2!==e.button&&3!==e.which)&&!(e.uiTreeDragging||e.originalEvent&&e.originalEvent.uiTreeDragging)){var r,l,d,u,b,y,S,x,N,E=angular.element(e.target);if(r=n.treeNodeHandlerContainerOfElement(E),r&&(E=angular.element(r)),l=i.clone(),x=n.elementIsTreeNode(E),N=n.elementIsTreeNodeHandle(E),(x||N)&&!(x&&n.elementContainsTreeNodeHandler(E)||(d=E.prop("tagName").toLowerCase(),"input"==d||"textarea"==d||"button"==d||"select"==d))){for(k=angular.element(e.target);k&&k[0]&&k[0]!==i;){if(n.nodrag(k))return;k=k.parent()}a.beforeDrag(a)&&(e.uiTreeDragging=!0,e.originalEvent&&(e.originalEvent.uiTreeDragging=!0),e.preventDefault(),b=n.eventObj(e),c=!0,s=n.dragInfo(a),u=i.prop("tagName"),"tr"===u.toLowerCase()?(m=angular.element(t.document.createElement(u)),y=angular.element(t.document.createElement("td")).addClass(X.placeholderClass).attr("colspan",i[0].children.length),m.append(y)):m=angular.element(t.document.createElement(u)).addClass(X.placeholderClass),f=angular.element(t.document.createElement(u)),X.hiddenClass&&f.addClass(X.hiddenClass),p=n.positionStarted(b,i),m.css("height",n.height(i)+"px"),h=angular.element(t.document.createElement(a.$parentNodesScope.$element.prop("tagName"))).addClass(a.$parentNodesScope.$element.attr("class")).addClass(X.dragClass),h.css("width",n.width(i)+"px"),h.css("z-index",9999),S=(i[0].querySelector(".angular-ui-tree-handle")||i[0]).currentStyle,S&&(document.body.setAttribute("ui-tree-cursor",o.find("body").css("cursor")||""),o.find("body").css({cursor:S.cursor+"!important"})),a.sourceOnly&&m.css("display","none"),i.after(m),i.after(f),s.isClone()&&a.sourceOnly?h.append(l):h.append(i),o.find("body").append(h),h.css({left:b.pageX-p.offsetX+"px",top:b.pageY-p.offsetY+"px"}),g={placeholder:m,dragging:h},O(),a.$apply(function(){a.$treeScope.$callbacks.dragStart(s.eventArgs(g,p))}),$=Math.max(I.scrollHeight,I.offsetHeight,_.clientHeight,_.scrollHeight,_.offsetHeight),v=Math.max(I.scrollWidth,I.offsetWidth,_.clientWidth,_.scrollWidth,_.offsetWidth))}}},y=function(e){var o,l,i,d,u,f,b,y,S,x,N,E,T,C,w,O,D,M=n.eventObj(e);if(h){if(e.preventDefault(),t.getSelection?t.getSelection().removeAllRanges():t.document.selection&&t.document.selection.empty(),i=M.pageX-p.offsetX,d=M.pageY-p.offsetY,i<0&&(i=0),d<0&&(d=0),d+10>$&&(d=$-10),i+10>v&&(i=v-10),h.css({left:i+"px",top:d+"px"}),u=window.pageYOffset||t.document.documentElement.scrollTop,f=u+(window.innerHeight||t.document.clientHeight||t.document.clientHeight),f<M.pageY&&f<$&&(w=Math.min($-f,10),window.scrollBy(0,w)),u>M.pageY&&window.scrollBy(0,-10),n.positionMoved(e,p,c),c)return void(c=!1);if(y=n.offset(h).left-n.offset(m).left>=X.threshold,S=M.pageX-(t.pageXOffset||t.document.body.scrollLeft||t.document.documentElement.scrollLeft)-(t.document.documentElement.clientLeft||0),x=M.pageY-(t.pageYOffset||t.document.body.scrollTop||t.document.documentElement.scrollTop)-(t.document.documentElement.clientTop||0),angular.isFunction(h.hide)?h.hide():(N=h[0].style.display,h[0].style.display="none"),t.document.elementFromPoint(S,x),T=angular.element(t.document.elementFromPoint(S,x)),H=n.treeNodeHandlerContainerOfElement(T),H&&(T=angular.element(H)),angular.isFunction(h.show)?h.show():h[0].style.display=N,A=!(n.elementIsTreeNodeHandle(T)||n.elementIsTreeNode(T)||n.elementIsTreeNodes(T)||n.elementIsTree(T)||n.elementIsPlaceholder(T)),A&&(m.remove(),V&&(V.resetEmptyElement(),V=null)),p.dirAx&&p.distAxX>=X.levelThreshold&&(p.distAxX=0,p.distX>0&&(o=s.prev(),o&&!o.collapsed&&o.accept(a,o.childNodesCount())&&(o.$childNodesScope.$element.append(m),s.moveTo(o.$childNodesScope,o.childNodes(),o.childNodesCount()))),p.distX<0&&(l=s.next(),l||(b=s.parentNode(),b&&b.$parentNodesScope.accept(a,b.index()+1)&&(b.$element.after(m),s.moveTo(b.$parentNodesScope,b.siblings(),b.index()+1))))),!p.dirAx){if(n.elementIsTree(T)?E=T.controller("uiTree").scope:n.elementIsTreeNodeHandle(T)?E=T.controller("uiTreeHandle").scope:n.elementIsTreeNode(T)?E=T.controller("uiTreeNode").scope:n.elementIsTreeNodes(T)?E=T.controller("uiTreeNodes").scope:n.elementIsPlaceholder(T)?E=T.controller("uiTreeNodes").scope:T.controller("uiTreeNode")&&(E=T.controller("uiTreeNode").scope),C=!1,!E)return;if(!E.$treeScope||E.$parent.nodropEnabled||E.$treeScope.nodropEnabled||m.css("display",""),"uiTree"==E.$type&&E.dragEnabled&&(C=E.isEmpty()),"uiTreeHandle"==E.$type&&(E=E.$nodeScope),"uiTreeNode"!=E.$type&&!C)return;V&&m.parent()[0]!=V.$element[0]&&(V.resetEmptyElement(),V=null),C?(V=E,E.$nodesScope.accept(a,0)&&(E.place(m),s.moveTo(E.$nodesScope,E.$nodesScope.childNodes(),0))):E.dragEnabled()&&(angular.isDefined(a.expandTimeoutOn)&&a.expandTimeoutOn!==E.id&&(r.cancel(a.expandTimeout),delete a.expandTimeout,delete a.expandTimeoutOn,a.$callbacks.expandTimeoutCancel()),E.collapsed&&(a.expandOnHover===!0||angular.isNumber(a.expandOnHover)&&0===a.expandOnHover?E.collapsed=!1:a.expandOnHover!==!1&&angular.isNumber(a.expandOnHover)&&a.expandOnHover>0&&angular.isUndefined(a.expandTimeoutOn)&&(a.expandTimeoutOn=E.$id,a.$callbacks.expandTimeoutStart(),a.expandTimeout=r(function(){a.$callbacks.expandTimeoutEnd(),E.collapsed=!1},a.expandOnHover))),T=E.$element,O=n.offset(T),D=E.horizontal?M.pageX<O.left+n.width(T)/2:M.pageY<O.top+n.height(T)/2,E.$parentNodesScope.accept(a,E.index())?D?(T[0].parentNode.insertBefore(m[0],T[0]),s.moveTo(E.$parentNodesScope,E.siblings(),E.index())):(T.after(m),s.moveTo(E.$parentNodesScope,E.siblings(),E.index()+1)):!D&&E.accept(a,E.childNodesCount())?(E.$childNodesScope.$element.append(m),s.moveTo(E.$childNodesScope,E.childNodes(),E.childNodesCount())):A=!0)}a.$apply(function(){a.$treeScope.$callbacks.dragMove(s.eventArgs(g,p))})}},S=function(e){var n=s.eventArgs(g,p);e.preventDefault(),D(),r.cancel(a.expandTimeout),a.$treeScope.$apply(function(){l.when(a.$treeScope.$callbacks.beforeDrop(n)).then(function(e){e!==!1&&a.$$allowNodeDrop&&!A?(s.apply(),a.$treeScope.$callbacks.dropped(n)):w()})["catch"](function(){w()})["finally"](function(){f.replaceWith(a.$element),m.remove(),h&&(h.remove(),h=null),a.$treeScope.$callbacks.dragStop(n),a.$$allowNodeDrop=!1,s=null;var e=document.body.getAttribute("ui-tree-cursor");null!==e&&(o.find("body").css({cursor:e}),document.body.removeAttribute("ui-tree-cursor"))})})},x=function(e){a.dragEnabled()&&b(e)},N=function(e){y(e)},E=function(e){a.$$allowNodeDrop=!0,S(e)},T=function(e){S(e)},C=function(){var e;return{exec:function(n,t){t||(t=0),this.cancel(),e=r(n,t)},cancel:function(){r.cancel(e)}}}(),w=function(){i.bind("touchstart mousedown",function(e){C.exec(function(){x(e)},a.dragDelay||0)}),i.bind("touchend touchcancel mouseup",function(){C.cancel()})},w(),O=function(){angular.element(o).bind("touchend",E),angular.element(o).bind("touchcancel",E),angular.element(o).bind("touchmove",N),angular.element(o).bind("mouseup",E),angular.element(o).bind("mousemove",N),angular.element(o).bind("mouseleave",T)},D=function(){angular.element(o).unbind("touchend",E),angular.element(o).unbind("touchcancel",E),angular.element(o).unbind("touchmove",N),angular.element(o).unbind("mouseup",E),angular.element(o).unbind("mousemove",N),angular.element(o).unbind("mouseleave",T)},M=function(e){27==e.keyCode&&(a.$$allowNodeDrop=!1,S(e))},angular.element(t.document).bind("keydown",M),a.$on("$destroy",function(){angular.element(t.document).unbind("keydown",M)})}}}])}(),function(){"use strict";angular.module("ui.tree").directive("uiTreeNodes",["treeConfig","$window",function(e){return{require:["ngModel","?^uiTreeNode","^uiTree"],restrict:"A",scope:!0,controller:"TreeNodesController",link:function(n,t,o,r){var l={},a=r[0],i=r[1],d=r[2];angular.extend(l,e),l.nodesClass&&t.addClass(l.nodesClass),i?(i.scope.$childNodesScope=n,n.$nodeScope=i.scope):d.scope.$nodesScope=n,n.$treeScope=d.scope,a&&(a.$render=function(){n.$modelValue=a.$modelValue}),n.$watch(function(){return o.maxDepth},function(e){"number"==typeof e&&(n.maxDepth=e)}),n.$watch(function(){return o.nodropEnabled},function(e){"undefined"!=typeof e&&(n.nodropEnabled=!0)},!0),o.$observe("horizontal",function(e){n.horizontal="undefined"!=typeof e})}}}])}(),function(){"use strict";function e(e,n){if(void 0===n)return null;for(var t=n.parentNode,o=1,r="function"==typeof t.setAttribute&&t.hasAttribute(e)?t:null;t&&"function"==typeof t.setAttribute&&!t.hasAttribute(e);){if(t=t.parentNode,r=t,t===document.documentElement){r=null;break}o++}return r}angular.module("ui.tree").factory("UiTreeHelper",["$document","$window","treeConfig",function(n,t,o){return{nodesData:{},setNodeAttribute:function(e,n,t){if(!e.$modelValue)return null;var o=this.nodesData[e.$modelValue.$$hashKey];o||(o={},this.nodesData[e.$modelValue.$$hashKey]=o),o[n]=t},getNodeAttribute:function(e,n){if(!e.$modelValue)return null;var t=this.nodesData[e.$modelValue.$$hashKey];return t?t[n]:null},nodrag:function(e){return"undefined"!=typeof e.attr("data-nodrag")&&"false"!==e.attr("data-nodrag")},eventObj:function(e){var n=e;return void 0!==e.targetTouches?n=e.targetTouches.item(0):void 0!==e.originalEvent&&void 0!==e.originalEvent.targetTouches&&(n=e.originalEvent.targetTouches.item(0)),n},dragInfo:function(e){return{source:e,sourceInfo:{cloneModel:e.$treeScope.cloneEnabled===!0?angular.copy(e.$modelValue):void 0,nodeScope:e,index:e.index(),nodesScope:e.$parentNodesScope},index:e.index(),siblings:e.siblings().slice(0),parent:e.$parentNodesScope,moveTo:function(e,n,t){this.parent=e,this.siblings=n.slice(0);var o=this.siblings.indexOf(this.source);o>-1&&(this.siblings.splice(o,1),this.source.index()<t&&t--),this.siblings.splice(t,0,this.source),this.index=t},parentNode:function(){return this.parent.$nodeScope},prev:function(){return this.index>0?this.siblings[this.index-1]:null},next:function(){return this.index<this.siblings.length-1?this.siblings[this.index+1]:null},isClone:function(){return this.source.$treeScope.cloneEnabled===!0},clonedNode:function(e){return angular.copy(e)},isDirty:function(){return this.source.$parentNodesScope!=this.parent||this.source.index()!=this.index},isForeign:function(){return this.source.$treeScope!==this.parent.$treeScope},eventArgs:function(e,n){return{source:this.sourceInfo,dest:{index:this.index,nodesScope:this.parent},elements:e,pos:n}},apply:function(){var e=this.source.$modelValue;this.parent.nodropEnabled||this.parent.$treeScope.nodropEnabled||this.isDirty()&&(this.isClone()&&this.isForeign()?this.parent.insertNode(this.index,this.sourceInfo.cloneModel):(this.source.remove(),this.parent.insertNode(this.index,e)))}}},height:function(e){return e.prop("scrollHeight")},width:function(e){return e.prop("scrollWidth")},offset:function(e){var o=e[0].getBoundingClientRect();return{width:e.prop("offsetWidth"),height:e.prop("offsetHeight"),top:o.top+(t.pageYOffset||n[0].body.scrollTop||n[0].documentElement.scrollTop),left:o.left+(t.pageXOffset||n[0].body.scrollLeft||n[0].documentElement.scrollLeft)}},positionStarted:function(e,n){var t={},o=e.pageX,r=e.pageY;return e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length>0&&(o=e.originalEvent.touches[0].pageX,r=e.originalEvent.touches[0].pageY),t.offsetX=o-this.offset(n).left,t.offsetY=r-this.offset(n).top,t.startX=t.lastX=o,t.startY=t.lastY=r,t.nowX=t.nowY=t.distX=t.distY=t.dirAx=0,t.dirX=t.dirY=t.lastDirX=t.lastDirY=t.distAxX=t.distAxY=0,t},positionMoved:function(e,n,t){var o,r=e.pageX,l=e.pageY;return e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches.length>0&&(r=e.originalEvent.touches[0].pageX,l=e.originalEvent.touches[0].pageY),n.lastX=n.nowX,n.lastY=n.nowY,n.nowX=r,n.nowY=l,n.distX=n.nowX-n.lastX,n.distY=n.nowY-n.lastY,n.lastDirX=n.dirX,n.lastDirY=n.dirY,n.dirX=0===n.distX?0:n.distX>0?1:-1,n.dirY=0===n.distY?0:n.distY>0?1:-1,o=Math.abs(n.distX)>Math.abs(n.distY)?1:0,t?(n.dirAx=o,void(n.moving=!0)):(n.dirAx!==o?(n.distAxX=0,n.distAxY=0):(n.distAxX+=Math.abs(n.distX),0!==n.dirX&&n.dirX!==n.lastDirX&&(n.distAxX=0),n.distAxY+=Math.abs(n.distY),0!==n.dirY&&n.dirY!==n.lastDirY&&(n.distAxY=0)),void(n.dirAx=o))},elementIsTreeNode:function(e){return"undefined"!=typeof e.attr("ui-tree-node")},elementIsTreeNodeHandle:function(e){return"undefined"!=typeof e.attr("ui-tree-handle")},elementIsTree:function(e){return"undefined"!=typeof e.attr("ui-tree")},elementIsTreeNodes:function(e){return"undefined"!=typeof e.attr("ui-tree-nodes")},elementIsPlaceholder:function(e){return e.hasClass(o.placeholderClass)},elementContainsTreeNodeHandler:function(e){return e[0].querySelectorAll("[ui-tree-handle]").length>=1},treeNodeHandlerContainerOfElement:function(n){return e("ui-tree-handle",n[0])}}}])}(),function(){var e=angular.module("mks-dashboard",["ngSanitize"]);e.component("dashboardNotifications",{templateUrl:["UrlBuilder",function(e){return e.get("templates/dashboard-notifications.html")}],bindings:{url:"@"},controller:["$http","UrlBuilder","$sce",function(e,n,t){function o(){var e=0;angular.forEach(l.items,function(n){n.read_at||e++}),l.unreadCount=e}function r(n,t){return!(t&&!confirm(t))&&void e.post(n).then(function(e){l.refresh()})}this.items=[],this.nextUrl=null,this.totalCount=0,this.unreadCount=0,this.currentItem=null,this.detailsHtml=null;var l=this;this.load=function(){e.get(this.nextUrl||this.url).then(function(e){e.data&&(l.items=l.items.concat(e.data.data),l.nextUrl=e.data.next_page_url,l.totalCount=e.data.total,o())})},this.details=function(r){e.get(n.get("dashboard/notification-details/"+r.id)).then(function(e){e.data&&(l.detailsHtml=t.trustAsHtml(e.data.details),r.read_at=e.data.read_at,o(),l.currentItem=r)})},this["delete"]=function(t,r){return!(r&&!confirm(r))&&void e.post(n.get("dashboard/notification-delete/"+t.id)).then(function(e){var n=l.items.indexOf(t);n>=0&&(l.items.splice(n,1),l.totalCount--,o())})},this.refresh=function(){this.items=[],this.nextUrl=null,this.load()},this.deleteRead=function(e){r(n.get("dashboard/notifications-delete"),e)},this.deleteAll=function(e){r(n.get("dashboard/notifications-delete/all"),e)},this.load()}]}),e.component("dashboardStatistics",{templateUrl:["UrlBuilder",function(e){return e.get("templates/dashboard-statistics.html")}],bindings:{url:"@"},controller:["$http","UrlBuilder",function(e,n){var t=this;this.items=[],this.load=function(){e.get(this.url).then(function(e){e.data&&(t.items=e.data)})},this.load()}]})}(window.angular),function(){var e=angular.module("mks-menu-manager",["ui.tree"]);e.controller("MenuController",["$scope","$http","UrlBuilder","$location",function(e,n,t,o){e.menu=[],e.currentMenu=null,e.menuModel=null,e.prevMenu=null,e.menuItems={};var r=this;e.init=function(o){n.get(t.get("menuman/list")).then(function(n){e.menu=n.data,e.menu.length&&(o?e.selectMenu(r.getMenu(o)):e.selectMenu(e.menu[0]))})},this.getMenu=function(n){for(var t=0;t<e.menu.length;t++)if(e.menu[t].id==n)return e.menu[t];return!1},this.getMenuIndex=function(n){for(var t=0;t<e.menu.length;t++)if(e.menu[t].id==n)return t;return!1},this.loadMenuItems=function(o){e.menuItems[o]||n.get(t.get("menuman/items/"+o)).then(function(n){e.menuItems[o]=n.data})},e.selectMenu=function(n){e.currentMenu=n,e.prevMenu=n,e.menuModel=null,r.loadMenuItems(n.id)},e.addMenu=function(){e.currentMenu=null,e.menuModel={active:!0}},e.editMenu=function(n){e.currentMenu=null,e.menuModel=angular.copy(n)},e.saveMenu=function(){return!!e.menuModel&&void n.post(t.get("menuman/save"),e.menuModel).then(function(n){if(!n.data.id)return!1;if(e.menuModel.id){var t=r.getMenuIndex(n.data.id);t>=0&&(e.menu[t]=n.data,e.selectMenu(e.menu[t]))}else e.menu.push(n.data),e.selectMenu(n.data)})},e.cancel=function(){return!(!e.menuModel||!e.prevMenu)&&void e.selectMenu(e.prevMenu)},e.deleteMenu=function(l,a){l.id&&confirm(a||"Delete?")&&n.post(t.get("menuman/delete"),{id:l.id}).then(function(n){e.menu.splice(r.getMenuIndex(l.id),1),o.path()=="/menuman/"+l.id?o.path("/menuman"):e.menu.length&&e.selectMenu(e.menu[0])})}}]),e.controller("MenuTreeController",["$http","UrlBuilder",function(e,n){this.menuItem=null;this.toggle=function(e){e.toggle()},this.remove=function(t,o){if(t.$nodeScope&&confirm(o||"Delete?")){var r=t.$nodeScope.$modelValue.id;e.post(n.get("menuman/items/delete/"+r)).then(function(e){t.remove()})}},this.treeOptions={beforeDrop:function(t){var o={old:{index:t.source.index,parent:null},"new":{index:t.dest.index,parent:null}};if(t.source.nodeScope.$parentNodeScope&&(o.old.parent=t.source.nodeScope.$parentNodeScope.$modelValue.id),t.dest.nodesScope.$nodeScope&&(o["new"].parent=t.dest.nodesScope.$nodeScope.$modelValue.id),o.old.index==o["new"].index&&o.old.parent==o["new"].parent)return!1;var r=t.source.nodeScope.$modelValue.menu_id,l=t.source.nodeScope.$modelValue.id;return e.post(n.get("menuman/items/"+r+"/move/"+l),o).then(function(e){return!0})}}}])}(window.angular),function(){var e=angular.module("mks-admin-ext",[]);e.factory("mksLinkService",["$q","$http","UrlBuilder",function(e,n,t){this.getParamsData=function(o){var r=e.defer(),l=n({method:"get",url:t.get("route/params"),params:o,timeout:r.promise}),a=l.then(function(e){return e.data},function(n){return e.reject("Something went wrong")});return a.abort=function(){r.resolve()},a["finally"](function(){a.abort=angular.noop,r=l=a=null}),a};var o=n.get(t.get("route")).then(function(e){return e.data});return this.getRoutes=function(){return o},this}]),e.directive("mksLinkSelect",["$http","mksLinkService","UrlBuilder",function(e,n,t){return{restrict:"E",scope:{model:"@model",rawEnabled:"@rawEnabled",emptyTitle:"@emptyTitle"},templateUrl:t.get("templates/link-selector.html"),link:function(e,t,o){function r(n){angular.forEach(e.items,function(t){t.id==n&&(e.routeOption=t)})}function l(){e.routeOption&&(a&&a.abort&&a.abort(),e.modal.loading=!0,(a=n.getParamsData({name:e.routeOption.id,page:e.modal.current_page||null,q:e.modal.searchQuery||null})).then(function(n){e.modal.data=n,i=e.routeOption.id,d=n.pagination?n.pagination.current_page:1,e.modal.current_page=d})["finally"](function(){e.modal.loading=!1}))}e.field={route:o.fieldRoute||"route[name]",params:o.fieldParams||"route[params]",raw:o.fieldRaw||"route[raw]"},e.items=[],e.routeOption=null,e.routes={},e.model&&e.$watch(e.model,function(n){n&&"undefined"!=typeof n.id&&(e.route=n)}),e.$watch(function(){return e.route},function(n){n&&"undefined"!=typeof n.id&&"undefined"==typeof e.routes[n.id]&&(e.routes[n.id]=n,r(n.id))}),e.route={id:o.route,title:o.title,params:o.params,raw:o.rawValue},n.getRoutes().then(function(n){e.items=n,e.route.id&&r(e.route.id)}),e.modal={id:"modal-"+(new Date).getTime(),loading:!1};var a=null,i=null,d=1;e.modal.open=function(){e.routeOption&&(e.routeOption.extended?i!=e.routeOption.id&&(e.modal.searchQuery="",l()):"undefined"!=typeof e.routes[e.routeOption.id]&&(e.modal.form=e.routes[e.routeOption.id].params),$("#"+e.modal.id).modal("show"))},e.modal.close=function(){$("#"+e.modal.id).modal("hide")},e.modal.select=function(n){if(e.modal.data.params&&e.routeOption){var t={};angular.forEach(e.modal.data.params,function(e){t[e]=n[e]}),e.routes[e.routeOption.id]={title:n.title,params:t},e.modal.close()}},e.modal.save=function(){e.modal.form&&e.routeOption&&(e.routes[e.routeOption.id]={title:e.paramsEncoded(e.modal.form),params:e.modal.form}),e.modal.close()},e.modal.prevPage=function(){"undefined"!=typeof e.modal.current_page&&e.modal.current_page>1&&e.modal.current_page--},e.modal.nextPage=function(){"undefined"!=typeof e.modal.current_page&&"undefined"!=typeof e.modal.data.pagination.last_page&&e.modal.current_page<e.modal.data.pagination.last_page&&e.modal.current_page++},e.$watch("modal.current_page",function(e,n){e&&e>0&&e!=d&&l()}),e.modal.search=function(n){1!=e.modal.current_page?e.modal.current_page=1:l()},e.paramsEncoded=function(e){return e&&"object"==typeof e?angular.toJson(e):e},e.paramsVisible=function(n){return n?n.title?n.title:e.paramsEncoded(n.params):""}}}}]),e.directive("mksModalPaginator",["$http","mksLinkService",function(e,n,t){return{restrict:"E",require:["^","@paginator"],scope:{paginator:"@paginator"},link:function(e,n,t){}}}]),e.directive("mksEditor",["AppConfig",function(e){return{restrict:"A",link:function(n,t,o){if("undefined"!=typeof CKEDITOR){var r={removePlugins:"forms,audio,Audio,allmedias",language:e.getLang("en")};if(o.mksEditor)try{angular.extend(r,n.$eval(o.mksEditor))}catch(l){}CKEDITOR.replace(t[0],r)}}}}]),e.run(["$rootScope",function(e){e.$on("$routeChangeStart",function(e,n,t){$(".modal.in").removeClass("in").hide(),$(".modal-backdrop").remove()})}])}(window.angular),function(){var e=angular.module("mks-admin-ext");e.controller("WidgetRoutesCtrl",["$scope","$http","UrlBuilder",function(e,n,t){e.routes=[];e.init=function(o){n.get(t.get("widget/routes"+(o?"/"+o:""))).then(function(n){e.routes=n.data,e.routes.length||e.addChoice()})},e.addChoice=function(){e.routes.push({id:null})},e.removeChoice=function(n){var t=e.routes.indexOf(n);t>=0&&e.routes.splice(t,1)}}])}(window.angular);